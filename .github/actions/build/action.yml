name: Build
description: Build packages and upload artifacts

inputs:
  upload-artifacts:
    description: Whether to upload dist artifacts
    default: 'false'

runs:
  using: composite
  steps:
    - name: Build all packages
      run: npx nx run-many -t build --all
      shell: bash

    - name: Upload dist artifacts
      if: inputs.upload-artifacts == 'true'
      uses: actions/upload-artifact@v4
      with:
        name: dist-artifacts
        path: |
          packages/*/dist
          apps/*/dist
        retention-days: 1
